<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç« ç³»çµ±å¾Œå°ç®¡ç† | Stamp System Admin</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%239fb28e' /%3E%3Ctext x='50' y='67' font-family='Arial' font-size='50' font-weight='bold' text-anchor='middle' fill='white'%3Eå°%3C/text%3E%3C/svg%3E">
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Admin CSS -->
    <link rel="stylesheet" href="admin.css">
    
    <!-- é˜²æ­¢è¢« iframe åµŒå…¥ -->
    <script>
        if (window.top !== window.self) {
            window.top.location = window.self.location;
        }
    </script>
    
    <style>
        /* åˆå§‹è¼‰å…¥å‹•ç•« */
        .initial-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #dde5d6;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 0.5s ease;
        }
        
        .loader-content {
            text-align: center;
        }
        
        .loader-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 24px;
            background: #9fb28e;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 32px rgba(159, 178, 142, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }
        
        .loader-logo .material-icons {
            font-size: 40px;
            color: white;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .loader-text {
            color: #84736a;
            font-size: 16px;
            font-weight: 500;
            opacity: 0;
            animation: fadeIn 0.5s ease 0.3s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .loader-progress {
            width: 200px;
            height: 4px;
            background: rgba(132, 115, 106, 0.1);
            border-radius: 2px;
            margin: 16px auto 0;
            overflow: hidden;
        }
        
        .loader-progress-bar {
            height: 100%;
            background: #9fb28e;
            border-radius: 2px;
            animation: loading 2s ease-in-out infinite;
        }
        
        @keyframes loading {
            0% { width: 0; transform: translateX(0); }
            50% { width: 100%; transform: translateX(0); }
            100% { width: 100%; transform: translateX(100%); }
        }
    </style>
</head>
<body>
    <!-- åˆå§‹è¼‰å…¥ç•«é¢ -->
    <div class="initial-loader" id="initialLoader">
        <div class="loader-content">
            <div class="loader-logo">
                <span class="material-icons">admin_panel_settings</span>
            </div>
            <div class="loader-text">å°ç« ç³»çµ±è¼‰å…¥ä¸­...</div>
            <div class="loader-progress">
                <div class="loader-progress-bar"></div>
            </div>
        </div>
    </div>
    
    <!-- ä¸»è¦å…§å®¹å€åŸŸ (ç”± JavaScript å‹•æ…‹ç”Ÿæˆ) -->
    
    <!-- é€šçŸ¥å®¹å™¨ -->
    <div id="notificationContainer" class="notification-container"></div>
    
    <!-- é˜²æˆªåœ–ä¿è­·å±¤ -->
    <div id="screenshotProtection" class="screenshot-protection">
        <span class="material-icons">no_photography</span>
        <p>ç¦æ­¢æˆªåœ–</p>
    </div>
    
    <!-- æµ®æ°´å°å±¤ (å¾Œå°ç”¨) -->
    <div id="watermarkLayer" class="watermark-layer"></div>
    
    <!-- è¼‰å…¥å¿…è¦çš„å‡½å¼åº« -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    
    <!-- Admin JavaScript -->
    <script src="admin.js"></script>
    
    <script>
        // ç³»çµ±åˆå§‹åŒ–
        window.addEventListener('load', function() {
            // ç§»é™¤è¼‰å…¥ç•«é¢
            setTimeout(() => {
                const loader = document.getElementById('initialLoader');
                if (loader) {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.remove(), 500);
                }
            }, 1000);
        });
        
        // æ•ˆèƒ½ç›£æ§
        if ('performance' in window) {
            window.addEventListener('load', function() {
                const perfData = window.performance.timing;
                const pageLoadTime = perfData.loadEventEnd - perfData.navigationStart;
                console.log(`âš¡ é é¢è¼‰å…¥æ™‚é–“: ${pageLoadTime}ms`);
            });
        }
        
        // ç¶²è·¯ç‹€æ…‹ç›£æ§
        let isOnline = navigator.onLine;
        
        window.addEventListener('online', function() {
            if (!isOnline) {
                isOnline = true;
                console.log('ğŸŒ ç¶²è·¯å·²é€£ç·š');
                if (window.showNotification) {
                    window.showNotification('ç¶²è·¯å·²æ¢å¾©é€£ç·š', 'success');
                }
            }
        });
        
        window.addEventListener('offline', function() {
            isOnline = false;
            console.log('ğŸ“µ ç¶²è·¯å·²æ–·ç·š');
            if (window.showNotification) {
                window.showNotification('ç¶²è·¯é€£ç·šä¸­æ–·ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ç„¡æ³•ä½¿ç”¨', 'warning');
            }
        });
        
        // ç€è¦½å™¨ç›¸å®¹æ€§æª¢æŸ¥
        (function checkCompatibility() {
            const features = {
                'CSS.supports': CSS && CSS.supports,
                'backdrop-filter': CSS && CSS.supports && (CSS.supports('backdrop-filter', 'blur(10px)') || CSS.supports('-webkit-backdrop-filter', 'blur(10px)')),
                'IntersectionObserver': 'IntersectionObserver' in window,
                'ResizeObserver': 'ResizeObserver' in window
            };
            
            const unsupported = Object.entries(features)
                .filter(([name, supported]) => !supported)
                .map(([name]) => name);
            
            if (unsupported.length > 0) {
                console.warn('âš ï¸ ç€è¦½å™¨ä¸å®Œå…¨æ”¯æ´ä»¥ä¸‹åŠŸèƒ½:', unsupported);
            }
        })();
        
        // è‡ªå‹•å„²å­˜åŠŸèƒ½
        let autoSaveTimer;
        window.enableAutoSave = function(callback, interval = 30000) {
            if (autoSaveTimer) clearInterval(autoSaveTimer);
            autoSaveTimer = setInterval(callback, interval);
        };
        
        window.disableAutoSave = function() {
            if (autoSaveTimer) {
                clearInterval(autoSaveTimer);
                autoSaveTimer = null;
            }
        };
        
        // éµç›¤å¿«æ·éµæç¤º
        console.log('%câŒ¨ï¸ å¿«æ·éµ:', 'font-size: 14px; font-weight: bold;');
        console.log('Ctrl+S - å„²å­˜è¨­å®š');
        console.log('Ctrl+O - è¼‰å…¥è¨­å®š');
        console.log('Ctrl+E - åŒ¯å‡ºè¨­å®š');
        console.log('Ctrl+/ - é¡¯ç¤ºå¿«æ·éµ');
        
        // éŒ¯èª¤è™•ç†
        window.addEventListener('error', function(e) {
            console.error('âŒ ç³»çµ±éŒ¯èª¤:', e.error);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            console.error('âŒ Promise éŒ¯èª¤:', e.reason);
            e.preventDefault();
        });
    </script>
    
    <!-- Meta æ¨™ç±¤ -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="theme-color" content="#9fb28e">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- é˜²æ­¢å¿«å–æ•æ„Ÿè³‡æ–™ -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</body>
</html>
